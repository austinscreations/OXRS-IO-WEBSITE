import{d as p,o,c,a as s,e,F as i,f as t,g as n}from"./app.b38cdf7f.js";import{_ as r}from"./plugin-vue_export-helper.21dcd24c.js";const l={},d=t(`<h1 id="esp-sensor-library" tabindex="-1"><a class="header-anchor" href="#esp-sensor-library" aria-hidden="true">#</a> ESP SENSOR library</h1><p class="maker">by <b>Austin&#39;s Creations</b></p><blockquote><p>SKU: OXRS-AC-SENSORS-ESP-LIB</p></blockquote><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>This library wraps up an i2c bus scanner + mqtt handling for qwiic / stemma I2C sensors</p><p>The library Supports</p><ul><li>BH1750 LUX sensor</li><li>SHT40 Temperature and Humidity Sensor</li><li>MCP9808 Temperature Sensor</li><li>PCF8523 RTC module</li><li>128x32 OLED Display</li></ul><p>Using this library means that config upon startup can be dynamic based on device configuration. all incoming and outgoing mqtt is handled by teh library, minimizing required code in main sketch. The library also handles the json payload for the OXRS API/MQTT adopt code. saving from having to copy / paste extra code in your main sketch. the adopt code is also dynamic - disabling elements that aren&#39;t connected.</p><hr><h3 id="dependencies" tabindex="-1"><a class="header-anchor" href="#dependencies" aria-hidden="true">#</a> Dependencies</h3><p>Library requires quite a few libraries</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Arduino.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;OXRS_MQTT.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ArduinoJson.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Wire.h&gt;</span>                     <span class="token comment">// For I2C</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Adafruit_MCP9808.h&gt;</span>         <span class="token comment">// For temp sensor</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Adafruit_SSD1306.h&gt;</span>         <span class="token comment">// For OLED display</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;RTClib.h&gt;</span>                   <span class="token comment">// For PCF8523 RTC</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BH1750.h&gt;</span>                   <span class="token comment">// For BH1750 lux sensor - non-adafruit library: https://github.com/claws/BH1750</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Adafruit_SHT4x.h&gt;</span>           <span class="token comment">// For SHT40 Temp / humidity sensor</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>ESP32<span class="token punctuation">)</span></span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;WiFi.h&gt;</span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ETH.h&gt;</span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Ethernet.h&gt;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>ESP8266<span class="token punctuation">)</span></span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ESP8266WiFi.h&gt;</span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Ethernet.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="setup" tabindex="-1"><a class="header-anchor" href="#setup" aria-hidden="true">#</a> Setup</h3><p>To use the library, ensure you have it downloaded / installed. The library is normally declared near the top of a sketch. after this is done the library isnatnce needs to be called / set. becuase the library uses i2c the <code>wire.begin();</code> should be called. you may need to include the SDA,SCL pin numbers in this declaration depending on hardware used.</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;OXRS_SENSORS.h&gt;</span>            <span class="token comment">// Declare the library</span></span>

OXRS_SENSORS <span class="token function">sensors</span><span class="token punctuation">(</span>mqtt<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// Create library isntance - * declare after mqtt</span>

Wire<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// Start I2C connection</span>
Wire<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span>SDA<span class="token punctuation">,</span>SCL<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// Start I2C connection, but with different I2C pins</span>

sensors<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// start the Library - placed within SETUP()</span>

sensors<span class="token punctuation">.</span><span class="token function">oled</span><span class="token punctuation">(</span>WiFi<span class="token punctuation">.</span><span class="token function">macAddress</span><span class="token punctuation">(</span>mac<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Called before setting up network - will show MAC on screen</span>
sensors<span class="token punctuation">.</span><span class="token function">oled</span><span class="token punctuation">(</span>Ethernet<span class="token punctuation">.</span><span class="token function">localIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Called after network setup - will now update display with IP address</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>There are also routines that need to be called within mqtt rountines.</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>sensors<span class="token punctuation">.</span><span class="token function">setConfigSchema</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Placed within main sketch ConfigSchema routine</span>

sensors<span class="token punctuation">.</span><span class="token function">setCommandSchema</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Placed within main sketch CommandSchema routine</span>

sensors<span class="token punctuation">.</span><span class="token function">conf</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// Placed within main sketch CONF callback routine</span>

sensors<span class="token punctuation">.</span><span class="token function">cmnd</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// Placed within main sketch CMND callback routine</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>See the libraries built in examples to better see how and where to place routines and callbacks</p><h3 id="program-loop" tabindex="-1"><a class="header-anchor" href="#program-loop" aria-hidden="true">#</a> Program Loop</h3><p>The main loop requires two routines, one keeps an OLED updated, the other updates the MQTT TELE topic with sensor data per the set interval</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// Required Routines in loop()</span>

sensors<span class="token punctuation">.</span><span class="token function">oled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// updates OLED</span>
sensors<span class="token punctuation">.</span><span class="token function">tele</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// update MQTT TELE per configured interval</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="config" tabindex="-1"><a class="header-anchor" href="#config" aria-hidden="true">#</a> Config</h3><p>The library can autoamtically handle incoming mqtt config payloads to control sensors</p><h3 id="command" tabindex="-1"><a class="header-anchor" href="#command" aria-hidden="true">#</a> Command</h3><p>The library can automatically handle incoming mqtt commands payloads to control sensors</p><h3 id="publishing" tabindex="-1"><a class="header-anchor" href="#publishing" aria-hidden="true">#</a> Publishing</h3><p>The library Automatically handles the sending of TELE data</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>These topics will be different if you set a topic prefix or suffix. E.g. a topic prefix of <code>home</code> and suffix of <code>oxrs</code> would result in a LWT topic of <code>home/stat/&lt;clientid&gt;/oxrs/lwt</code></p></div><table><thead><tr><th style="text-align:left;">Publish API</th><th style="text-align:left;">Topic</th><th style="text-align:left;">Retained</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>publishTelemetry</code></td><td style="text-align:left;"><code>tele/&lt;clientid&gt;</code></td><td style="text-align:left;">false</td><td style="text-align:left;">Publish a JSON <strong>telemetry</strong> message, e.g. when publishing regular sensor data</td></tr></tbody></table><h2 id="downloads" tabindex="-1"><a class="header-anchor" href="#downloads" aria-hidden="true">#</a> Downloads</h2>`,30),u=n("Download the latest version of the library on "),h={href:"https://github.com/austinscreations/OXRS-AC-I2CSensors-ESP-LIB",target:"_blank",rel:"noopener noreferrer"},k=n("Github"),m=n("."),b=t('<h2 id="supported-hardware" tabindex="-1"><a class="header-anchor" href="#supported-hardware" aria-hidden="true">#</a> Supported Hardware</h2><p>This library is compatible with ESP32 and ESP8266 microprocessors.</p><hr><h4 id="credits" tabindex="-1"><a class="header-anchor" href="#credits" aria-hidden="true">#</a> Credits</h4><ul><li>Austins Creations</li><li>Ben Jones</li></ul><hr><h4 id="license" tabindex="-1"><a class="header-anchor" href="#license" aria-hidden="true">#</a> License</h4>',7),g=n("Found "),f={href:"https://github.com/austinscreations/OXRS-AC-I2CSensors-ESP-LIB/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer"},y=n("here"),v=n(".");function S(w,x){const a=p("ExternalLinkIcon");return o(),c(i,null,[d,s("p",null,[u,s("a",h,[k,e(a)]),m]),b,s("p",null,[g,s("a",f,[y,e(a)]),v])],64)}var C=r(l,[["render",S]]);export{C as default};
